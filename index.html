import React, { useState, useEffect } from 'react';
import { LogOut, BookOpen, BarChart3, Settings, Table, PlusSquare, LineChart, CornerDownRight, AlertTriangle, CheckCircle, Clock } from 'lucide-react';
// IMPORTAÇÕES DO FIREBASE (necessárias para salvar o formulário)
// AVISO: Estas importações são simuladas no ambiente de um arquivo único JSX.
// Na implementação real, estas bibliotecas seriam importadas via `import { ... } from 'firebase/...'`
const simulatedFirebase = {
    // A simulação de um objeto Firebase para evitar erros de referência no JSX
    // Em uma aplicação real, aqui estariam as instâncias `db` e `auth`
    db: {
        collection: (path) => ({
            addDoc: async (data) => {
                await new Promise(resolve => setTimeout(resolve, 500));
                return { id: `CRISE-${Math.floor(Math.random() * 10000)}` };
            }
        })
    },
    userId: 'user_evereste_123',
    appId: 'crise2',
};

// --- Constantes de Autenticação (SENHA ÚNICA) ---
const CORRECT_PASSWORD = 'Evereste@2025';
const SIMULATED_2FA_CODE = '123456'; // Código fixo para simulação

// --- Componente do Formulário de Registro de Crise (Boletim de Ocorrência) ---
const CrisisForm = () => {
    // 1. Estados para o formulário 
    const [formData, setFormData] = useState({
        nomeResponsavel: '',
        cargoResponsavel: '',
        contatoResponsavel: '',
        fatoGerador: '',
        dataOcorrencia: '',
        setorEnvolvido: '',
        descricaoDetalhada: '',
        acoesImediatasLivre: '',
        equipeDesignada: '',
        planoDetalhado: '',
    });
    const [loading, setLoading] = useState(false);
    const [feedback, setFeedback] = useState(null);
    const [canaisDeteccao, setCanaisDeteccao] = useState([]);
    const [classificacao, setClassificacao] = useState('');
    const [impactoEstimado, setImpactoEstimado] = useState([]);

    useEffect(() => {
        // Preenche a data e hora do registro automaticamente
        const input = document.getElementById('registro-data-hora');
        if (input) {
             input.value = new Date().toLocaleString('pt-BR', { dateStyle: 'long', timeStyle: 'short' });
        }
    }, []);

    const handleChange = (e) => {
        const { id, value, type, checked, name } = e.target;

        if (type === 'checkbox') {
            if (name === 'canal-deteccao') {
                setCanaisDeteccao(prev => 
                    checked ? [...prev, value] : prev.filter(v => v !== value)
                );
            } else if (name === 'impacto-estimado') {
                setImpactoEstimado(prev => 
                    checked ? [...prev, value] : prev.filter(v => v !== value)
                );
            }
        } else if (type === 'radio') {
            if (name === 'classificacao') {
                setClassificacao(value);
            }
        } else {
            // Lida com todos os campos de texto/data em formData
            setFormData(prev => ({ ...prev, [id]: value }));
        }
    };

    const handleFormSubmission = async (e) => {
        e.preventDefault();
        setLoading(true);
        setFeedback(null);

        if (!classificacao || impactoEstimado.length === 0 || canaisDeteccao.length === 0) {
             setFeedback({
                type: 'error',
                message: `Campos de seleção obrigatórios (Classificação, Impacto e Canal) não foram preenchidos.`,
            });
            setLoading(false);
            return;
        }

        const dataToSave = {
            ...formData,
            dataRegistro: document.getElementById('registro-data-hora').value,
            canaisDeteccao: canaisDeteccao.join('; '),
            classificacao: classificacao,
            impactoEstimado: impactoEstimado.join('; '),
            timestamp: new Date().toISOString(),
            registeredByUid: simulatedFirebase.userId,
            appId: simulatedFirebase.appId,
            status: 'Em Análise',
        };

        try {
            // Simulação de salvamento no Firestore
            const collectionPath = `artifacts/${simulatedFirebase.appId}/users/${simulatedFirebase.userId}/boletins_crise`;
            const docRef = await simulatedFirebase.db.collection(collectionPath).addDoc(dataToSave);
            
            setFeedback({
                type: 'success',
                message: `Boletim Registrado com Sucesso! ID: ${docRef.id}`,
            });

            // Resetar formulário após sucesso (opcional)
            setFormData({
                nomeResponsavel: '', cargoResponsavel: '', contatoResponsavel: '', 
                fatoGerador: '', dataOcorrencia: '', setorEnvolvido: '',
                descricaoDetalhada: '', acoesImediatasLivre: '', equipeDesignada: '', planoDetalhado: ''
            });
            setCanaisDeteccao([]);
            setClassificacao('');
            setImpactoEstimado([]);

        } catch (error) {
            console.error("Erro ao salvar o Boletim de Ocorrência:", error);
            setFeedback({
                type: 'error',
                message: `Erro ao Registrar: ${error.message}. Verifique a console.`,
            });
        } finally {
            setLoading(false);
        }
    };

    // Estilos auxiliares
    const requiredLabelClass = "block text-sm font-medium text-gray-700 after:content-['*'] after:text-red-500 after:ml-1";
    const inputClass = "mt-1 block w-full rounded-md border border-gray-300 p-3 shadow-sm focus:ring-blue-500 focus:border-blue-500";

    return (
        <div className="p-8 max-w-7xl mx-auto">
            <header className="mb-8 border-b pb-4">
                <h1 className="text-3xl font-extrabold text-blue-900 mb-2">Registro de Ocorrência</h1>
                <h2 className="text-xl font-semibold text-gray-700">Boletim de Ocorrência – Gestão de Crise de Imagem</h2>
                <p className="mt-2 text-gray-500 italic text-sm">Preencha todos os campos obrigatórios para salvar o registro da crise.</p>
            </header>

            <form onSubmit={handleFormSubmission} className="space-y-8">
                
                {/* Área de Feedback */}
                {feedback && (
                    <div className={`p-4 rounded-lg border ${feedback.type === 'success' ? 'bg-green-100 border-green-300 text-green-800' : 'bg-red-100 border-red-300 text-red-800'}`}>
                        <p className="font-semibold">{feedback.message}</p>
                    </div>
                )}

                {/* 1. IDENTIFICAÇÃO */}
                <section className="p-6 bg-gray-50 rounded-lg border border-gray-200">
                    <h3 className="text-2xl font-bold text-blue-800 mb-4">1. Identificação do Registro</h3>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label className={requiredLabelClass} htmlFor="registro-data-hora">Data e Hora do Registro</label>
                            <input type="text" id="registro-data-hora" className={`${inputClass} bg-gray-100`} readOnly defaultValue="" />
                        </div>
                        <div>
                            <label className={requiredLabelClass} htmlFor="nomeResponsavel">Nome do Responsável</label>
                            <input type="text" id="nomeResponsavel" value={formData.nomeResponsavel} onChange={handleChange} placeholder="Seu nome completo" className={inputClass} required />
                        </div>
                        <div>
                            <label className={requiredLabelClass} htmlFor="cargoResponsavel">Cargo/Setor</label>
                            <input type="text" id="cargoResponsavel" value={formData.cargoResponsavel} onChange={handleChange} placeholder="Ex: Analista de Comunicação" className={inputClass} required />
                        </div>
                        <div>
                            <label className={requiredLabelClass} htmlFor="contatoResponsavel">Telefone/WhatsApp</label>
                            <input type="tel" id="contatoResponsavel" value={formData.contatoResponsavel} onChange={handleChange} placeholder="(XX) 9XXXX-XXXX" className={inputClass} required />
                        </div>
                    </div>
                </section>

                {/* 2. DETALHES DA CRISE */}
                <section className="p-6 bg-white rounded-lg border border-gray-200">
                    <h3 className="text-2xl font-bold text-blue-800 mb-4">2. Detalhes da Crise</h3>

                    <div className="mb-6">
                        <label className={requiredLabelClass} htmlFor="fatoGerador">Fato Gerador da Crise (Resumo Executivo)</label>
                        <textarea id="fatoGerador" rows="4" value={formData.fatoGerador} onChange={handleChange} placeholder="Descreva de forma concisa o evento que desencadeou a crise." className={inputClass} required minLength="50"></textarea>
                    </div>

                    <div className="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                        <div>
                            <label className={requiredLabelClass} htmlFor="dataOcorrencia">Data e Hora do Ocorrido</label>
                            <input type="datetime-local" id="dataOcorrencia" value={formData.dataOcorrencia} onChange={handleChange} className={inputClass} required />
                        </div>
                        <div>
                            <label className={requiredLabelClass} htmlFor="setorEnvolvido">Área/Setor Envolvido (Principal)</label>
                            <input type="text" id="setorEnvolvido" value={formData.setorEnvolvido} onChange={handleChange} placeholder="Ex: Marketing, Financeiro" className={inputClass} required />
                        </div>
                    </div>

                    {/* Canal de Detecção */}
                    <div className="mb-6">
                        <label className={requiredLabelClass}>Canal de Detecção (Múltipla Escolha)</label>
                        <div className="mt-2 grid grid-cols-2 sm:grid-cols-4 gap-3 p-3 bg-blue-50 rounded-md">
                            {['E-mail', 'Instagram', 'WhatsApp', 'LinkedIn', 'Imprensa Tradicional', 'Google/Reviews', 'YouTube/TikTok', 'Reclamações Online', 'Outros'].map(canal => (
                                <label key={canal} className="flex items-center space-x-2">
                                    <input type="checkbox" name="canal-deteccao" value={canal} onChange={handleChange} checked={canaisDeteccao.includes(canal)} className="rounded text-blue-600" />
                                    <span>{canal}</span>
                                </label>
                            ))}
                        </div>
                    </div>
                </section>
                
                {/* 3. CLASSIFICAÇÃO E IMPACTO */}
                <section className="p-6 bg-gray-50 rounded-lg border border-gray-200">
                    <h3 className="text-2xl font-bold text-blue-800 mb-4">3. Classificação e Impacto da Crise</h3>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                        {/* Classificação da Crise */}
                        <div>
                            <label className={requiredLabelClass}>Classificação da Crise (Nível de Risco)</label>
                            <div className="mt-2 space-y-2 p-3 bg-red-50 rounded-md">
                                {['Sem Relevância Crítica', 'Potencial', 'Moderada', 'Grave', 'Extrema / Reputacional'].map(nivel => (
                                    <label key={nivel} className="flex items-center space-x-2">
                                        <input type="radio" name="classificacao" value={nivel} onChange={handleChange} checked={classificacao === nivel} className="text-red-600" required />
                                        <span>{nivel}</span>
                                    </label>
                                ))}
                            </div>
                        </div>

                        {/* Impacto Estimado */}
                        <div>
                            <label className={requiredLabelClass}>Impacto(s) Estimado(s) (Múltiplo)</label>
                            <div className="mt-2 space-y-2 p-3 bg-gray-100 rounded-md">
                                {['Reputacional', 'Financeiro', 'Jurídico', 'Operacional', 'Pessoas'].map(impacto => (
                                    <label key={impacto} className="flex items-center space-x-2">
                                        <input type="checkbox" name="impacto-estimado" value={impacto} onChange={handleChange} checked={impactoEstimado.includes(impacto)} className="rounded text-blue-600" />
                                        <span>{impacto}</span>
                                    </label>
                                ))}
                            </div>
                        </div>
                    </div>
                </section>
                
                {/* 4. DESCRIÇÃO E ANEXOS */}
                <section className="p-6 bg-white rounded-lg border border-gray-200">
                    <h3 className="text-2xl font-bold text-blue-800 mb-4">4. Descrição Detalhada e Indícios</h3>

                    <div className="mb-6">
                        <label className={requiredLabelClass} htmlFor="descricaoDetalhada">Descrição Detalhada do Ocorrido</label>
                        <textarea id="descricaoDetalhada" rows="6" value={formData.descricaoDetalhada} onChange={handleChange} placeholder="Inclua o contexto, a repercussão inicial e a linha do tempo." className={inputClass} required></textarea>
                    </div>

                    <div>
                        <label className={requiredLabelClass} htmlFor="anexos">Anexos/Indícios Registrados (Máx. 10 arquivos)</label>
                        <div className="file-upload-box mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-dashed border-blue-300 bg-blue-50 rounded-md hover:bg-blue-100">
                            <div className="space-y-1 text-center">
                                <svg className="mx-auto h-12 w-12 text-blue-400" stroke="currentColor" fill="none" viewBox="0 0 48 48" aria-hidden="true">
                                    <path d="M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-8m32-12l-3.232 3.232a4.492 4.492 0 00-.776 1.748L24 24M16 8h4m-4 0v4m-4 0h4m-4 0v4m4-4h4m-4 0v4m-4 0h4m-4 0v4m4-4h4m-4 0v4m-4 0h4m-4 0v4m4-4h4m-4 0v4m-4 0h4" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" />
                                </svg>
                                <div className="flex text-sm text-gray-600">
                                    <label htmlFor="anexos" className="relative cursor-pointer rounded-md bg-white font-medium text-blue-600 hover:text-blue-500 p-1">
                                        <span>Fazer upload dos arquivos</span>
                                        <input id="anexos" name="anexos" type="file" className="sr-only" multiple accept="image/*, application/pdf, video/*" max="10" />
                                    </label>
                                    <p className="pl-1">ou arraste e solte</p>
                                </div>
                                <p className="text-xs text-gray-500">Máx. 10 arquivos (Imagens, PDFs, Vídeos curtos).</p>
                            </div>
                        </div>
                    </div>
                </section>
                
                {/* 5. AÇÕES, EQUIPE E PLANO (Simplificado) */}
                <section className="p-6 bg-gray-50 rounded-lg border border-gray-200">
                    <h3 className="text-2xl font-bold text-blue-800 mb-4">5. Ações e Plano de Contenção</h3>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label className={requiredLabelClass} htmlFor="acoesImediatasLivre">Ações Imediatas Tomadas</label>
                            <textarea id="acoesImediatasLivre" rows="3" value={formData.acoesImediatasLivre} onChange={handleChange} placeholder="Ex: Remoção de conteúdo, acionamento jurídico, nota preliminar." className={inputClass} required></textarea>
                        </div>
                        <div>
                            <label className={requiredLabelClass} htmlFor="equipeDesignada">Equipe Designada</label>
                            <input type="text" id="equipeDesignada" value={formData.equipeDesignada} onChange={handleChange} placeholder="Ex: Porta-voz, Jurídico, Comunicação Externa" className={inputClass} required />
                        </div>
                    </div>
                    <div className="mt-6">
                         <label className={requiredLabelClass} htmlFor="planoDetalhado">Plano de Ação em Execução (Detalhes)</label>
                         <textarea id="planoDetalhado" rows="4" value={formData.planoDetalhado} onChange={handleChange} placeholder="Descreva os detalhes do plano, incluindo datas, responsáveis e o status atual." className={inputClass} required></textarea>
                    </div>
                </section>


                {/* Botão de Envio */}
                <div className="flex justify-center pt-8 border-t mt-8">
                    <button
                        type="submit"
                        disabled={loading}
                        className="bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-8 rounded-lg transition duration-300 transform hover:scale-105 focus:outline-none focus:ring-4 focus:ring-green-500 focus:ring-opacity-50 disabled:opacity-50"
                    >
                        {loading ? 'Salvando Registro...' : 'Salvar Ocorrência Registrada'}
                    </button>
                </div>
            </form>
        </div>
    );
};

// --- Componente de Tela de Registro (Placeholder substituído) ---
const RegisterScreen = () => <CrisisForm />;

// --- Componente de Navegação Lateral
const Sidebar = ({ currentView, setView, onLogout }) => {
    const navItems = [
        { id: 'dashboard', label: 'Dashboard Analítico', icon: BarChart3 },
        { id: 'register', label: 'Registrar Ocorrência', icon: PlusSquare },
        { id: 'list', label: 'Listar Ocorrências', icon: Table },
        { id: 'charts', label: 'Gerar Gráficos', icon: LineChart },
        { id: 'reports', label: 'Exportar Relatórios (PDF)', icon: BookOpen },
        { id: 'config', label: 'Configurações', icon: Settings },
    ];

    return (
        <div className="w-64 bg-gray-900 text-white flex flex-col h-full shadow-lg">
            <div className="p-6 border-b border-gray-700">
                <h1 className="text-xl font-bold text-blue-400">EVERESTE CRISES</h1>
                <p className="text-xs text-gray-400 mt-1">Gestão de Imagem & Reputação</p>
            </div>
            <nav className="flex-grow p-4 space-y-2">
                {navItems.map(item => (
                    <button
                        key={item.id}
                        onClick={() => setView(item.id)}
                        className={`w-full flex items-center p-3 rounded-lg transition-colors duration-200 ${
                            currentView === item.id 
                                ? 'bg-blue-600 text-white font-semibold shadow-md' 
                                : 'text-gray-300 hover:bg-gray-800 hover:text-blue-400'
                        }`}
                    >
                        <item.icon className="w-5 h-5 mr-3" />
                        <span>{item.label}</span>
                    </button>
                ))}
            </nav>
            <div className="p-4 border-t border-gray-700">
                <button
                    onClick={onLogout}
                    className="w-full flex items-center p-3 rounded-lg bg-red-600 hover:bg-red-700 text-white font-semibold transition-colors duration-200"
                >
                    <LogOut className="w-5 h-5 mr-3" />
                    <span>Sair</span>
                </button>
            </div>
        </div>
    );
};

// 2. Componente de Tela de Login (Com validação e 2FA simulada)
const LoginScreen = ({ onLoginSuccess }) => {
    const [email, setEmail] = useState('');
    const [password, setPassword] = useState('');
    const [twoFactorCode, setTwoFactorCode] = useState('');
    const [step, setStep] = useState(1); // 1: Email/Pass, 2: 2FA Code
    const [error, setError] = useState('');
    const [loading, setLoading] = useState(false);

    const handleLogin = (e) => {
        e.preventDefault();
        setError('');
        setLoading(true);

        // 1. Validação de Senha
        if (password !== CORRECT_PASSWORD) {
            setError('Credenciais inválidas. Verifique e-mail e senha.');
            setLoading(false);
            return;
        }
        
        // 2. Simulação de 2FA - Transição de Etapa
        // No mundo real: Aqui a API enviaria o código por email para o e-mail digitado.
        setTimeout(() => {
            setStep(2);
            setLoading(false);
        }, 1000);
    };

    const handleTwoFactorSubmit = (e) => {
        e.preventDefault();
        setLoading(true);
        setError('');

        if (twoFactorCode === SIMULATED_2FA_CODE) { // Código simulado
            setTimeout(() => {
                onLoginSuccess();
                setLoading(false);
            }, 500);
        } else {
            setError('Código de verificação inválido. Tente novamente.');
            setLoading(false);
        }
    };

    return (
        <div className="min-h-screen flex items-center justify-center bg-gray-100">
            <div className="w-full max-w-md p-8 space-y-6 bg-white rounded-xl shadow-2xl">
                <div className="text-center">
                    <AlertTriangle className="mx-auto w-10 h-10 text-red-600 mb-2" />
                    <h2 className="text-3xl font-bold text-gray-900">Acesso Restrito</h2>
                    <p className="mt-2 text-sm text-gray-500">Instituto Evereste - Gestão de Crises</p>
                </div>

                <form className="space-y-4" onSubmit={step === 1 ? handleLogin : handleTwoFactorSubmit}>
                    {error && <p className="text-sm text-red-600 bg-red-50 p-3 rounded-md border border-red-200">{error}</p>}

                    {step === 1 ? (
                        <>
                            <div>
                                <label className="block text-sm font-medium text-gray-700">E-mail</label>
                                <input
                                    type="email"
                                    value={email}
                                    onChange={(e) => setEmail(e.target.value)}
                                    placeholder="ex: seu.email@empresa.org.br"
                                    required
                                    className="mt-1 w-full p-3 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"
                                />
                            </div>
                            <div>
                                <label className="block text-sm font-medium text-gray-700">Senha</label>
                                <input
                                    type="password"
                                    value={password}
                                    onChange={(e) => setPassword(e.target.value)}
                                    placeholder="Evereste@2025"
                                    required
                                    className="mt-1 w-full p-3 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"
                                />
                            </div>
                        </>
                    ) : (
                        <div>
                            <p className="text-sm text-gray-600 mb-3">
                                <CheckCircle className="inline w-4 h-4 text-green-500 mr-1"/>
                                Um código de verificação foi simuladamente enviado para **{email}**.
                            </p>
                            
                            {/* EXIBIÇÃO DO CÓDIGO SIMULADO PARA O TESTE */}
                            <div className="p-2 bg-blue-100 border border-blue-300 text-blue-800 text-center rounded-md text-sm font-semibold mb-3">
                                SIMULAÇÃO: O código é <span className="text-xl tracking-widest">{SIMULATED_2FA_CODE}</span>
                            </div>

                            <label className="block text-sm font-medium text-gray-700">Código de Verificação (2FA)</label>
                            <input
                                type="text"
                                value={twoFactorCode}
                                onChange={(e) => setTwoFactorCode(e.target.value)}
                                placeholder="Insira o código de 6 dígitos"
                                required
                                maxLength="6"
                                className="mt-1 w-full p-3 border border-gray-300 rounded-md text-center text-xl tracking-widest focus:ring-blue-500 focus:border-blue-500"
                            />
                        </div>
                    )}

                    <button
                        type="submit"
                        disabled={loading}
                        className="w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition duration-150"
                    >
                        {loading ? 'Processando...' : (step === 1 ? 'Entrar' : 'Verificar e Acessar')}
                    </button>
                </form>
            </div>
        </div>
    );
};

// 3. Telas do Dashboard (Simuladas - Placeholder)
const DashboardScreen = () => (
    <div className="p-8">
        <h2 className="text-3xl font-bold text-gray-800 border-b pb-2 mb-6">Dashboard Analítico</h2>
        <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
            <StatsCard title="Crises Ativas" value="3" color="red" />
            <StatsCard title="Registros Mensais" value="15" color="blue" />
            <StatsCard title="Gravidade Média" value="3.8/5.0" color="orange" />
        </div>
        <p className="mt-8 text-lg text-gray-600">
            [Gráficos automáticos como: quantidade de crises por período, por gravidade, impacto estimado, canal, etc. seriam carregados aqui usando Recharts/Chart.js.]
        </p>
        <button className="mt-4 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition">
            Exportar Dashboard (PDF)
        </button>
    </div>
);


const ListScreen = () => (
    <div className="p-8">
        <h2 className="text-3xl font-bold text-gray-800 border-b pb-2 mb-6">Listagem de Ocorrências</h2>
        <p className="text-gray-600">
            [Tabela com filtros completos por Período, Data Específica, Gravidade, Impacto, Canal, Reincidência e Campo de Busca para Descrição Detalhada seria construída aqui.]
        </p>
        <TableComponent />
    </div>
);

const ChartsScreen = () => (
    <div className="p-8">
        <h2 className="text-3xl font-bold text-gray-800 border-b pb-2 mb-6">Gerador de Gráficos Manual</h2>
        <p className="text-gray-600">
            [Formulário para o usuário selecionar Tipo de Gráfico (barra, pizza, linha), Filtros, Período e Campo Desejado (gravidade, impacto, canal). Botões "Gerar Gráfico" e "Exportar PDF" seriam implementados.]
        </p>
    </div>
);

const ReportsScreen = () => (
    <div className="p-8">
        <h2 className="text-3xl font-bold text-gray-800 border-b pb-2 mb-6">Exportação de Relatórios (PDF)</h2>
        <p className="text-gray-600">
            [Funcionalidade para gerar PDF contendo dados completos, gráficos selecionados, relatórios técnicos e metadados. Usaria uma biblioteca como jsPDF.]
        </p>
    </div>
);

const ConfigScreen = () => (
    <div className="p-8">
        <h2 className="text-3xl font-bold text-gray-800 border-b pb-2 mb-6">Configurações do Sistema</h2>
        <p className="text-gray-600">
            [Área para gerenciar usuários, atualizar a senha única `Evereste@2025`, e gerenciar listas pré-definidas (canais de detecção, classificações de crise).]
        </p>
    </div>
);


// 4. Componentes Auxiliares
const StatsCard = ({ title, value, color }) => (
    <div className={`p-5 bg-white rounded-lg shadow-lg border-l-4 border-${color}-500 transition duration-300 hover:shadow-xl`}>
        <p className="text-sm font-medium text-gray-500">{title}</p>
        <p className={`mt-1 text-3xl font-extrabold text-${color}-700`}>{value}</p>
    </div>
);

const TableComponent = () => {
    const mockData = [
        { id: 1001, date: '2025-11-20', channel: 'Instagram', area: 'Marketing', severity: 'Extrema', impact: 'Reputacional/Financeiro', status: 'Em Análise' },
        { id: 1002, date: '2025-11-18', channel: 'Imprensa', area: 'Diretoria', severity: 'Grave', impact: 'Jurídico/Reputacional', status: 'Em Execução' },
        { id: 1003, date: '2025-11-15', channel: 'ReclameAqui', area: 'SAC', severity: 'Moderada', impact: 'Operacional', status: 'Encerrada' },
    ];

    return (
        <div className="mt-6 bg-white p-4 rounded-lg shadow-inner">
            <h4 className="text-xl font-semibold mb-4">Últimas Ocorrências</h4>
            <div className="overflow-x-auto">
                <table className="min-w-full divide-y divide-gray-200">
                    <thead className="bg-gray-50">
                        <tr>
                            {['Nº', 'Data', 'Canal', 'Área', 'Gravidade', 'Impacto', 'Status', 'Ações'].map(header => (
                                <th key={header} className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">{header}</th>
                            ))}
                        </tr>
                    </thead>
                    <tbody className="bg-white divide-y divide-gray-200">
                        {mockData.map(item => (
                            <tr key={item.id} className="hover:bg-blue-50">
                                <td className="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">{item.id}</td>
                                <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{item.date}</td>
                                <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{item.channel}</td>
                                <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{item.area}</td>
                                <td className="px-6 py-4 whitespace-nowrap text-sm">
                                    <span className={`inline-flex px-2 text-xs leading-5 font-semibold rounded-full ${
                                        item.severity === 'Extrema' ? 'bg-red-100 text-red-800' :
                                        item.severity === 'Grave' ? 'bg-orange-100 text-orange-800' : 'bg-green-100 text-green-800'
                                    }`}>{item.severity}</span>
                                </td>
                                <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{item.impact}</td>
                                <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{item.status}</td>
                                <td className="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                    <button className="text-blue-600 hover:text-blue-900 text-xs flex items-center">
                                        <CornerDownRight className="w-4 h-4 mr-1"/> Ver detalhes
                                    </button>
                                </td>
                            </tr>
                        ))}
                    </tbody>
                </table>
            </div>
        </div>
    );
};


// 5. Componente Principal App
const App = () => {
    const [isLoggedIn, setIsLoggedIn] = useState(false);
    const [currentView, setCurrentView] = useState('dashboard');

    // Simulação: Verifica o estado de login ao carregar
    useEffect(() => {
        // No mundo real, verificaríamos um token de sessão ou localStorage
        // Por enquanto, fica falso para forçar a tela de login.
    }, []);

    const handleLoginSuccess = () => {
        setIsLoggedIn(true);
        setCurrentView('dashboard');
    };

    const handleLogout = () => {
        setIsLoggedIn(false);
        setCurrentView('dashboard'); // Volta para login/tela inicial
    };

    const renderView = () => {
        switch (currentView) {
            case 'register': return <RegisterScreen />;
            case 'list': return <ListScreen />;
            case 'charts': return <ChartsScreen />;
            case 'reports': return <ReportsScreen />;
            case 'config': return <ConfigScreen />;
            case 'dashboard':
            default: return <DashboardScreen />;
        }
    };

    if (!isLoggedIn) {
        return <LoginScreen onLoginSuccess={handleLoginSuccess} />;
    }

    return (
        <div className="flex h-screen overflow-hidden">
            <Sidebar currentView={currentView} setView={setCurrentView} onLogout={handleLogout} />
            <main className="flex-1 overflow-y-auto bg-gray-50">
                {renderView()}
            </main>
        </div>
    );
};

export default App;

