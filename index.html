<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Evereste - Gestão de Crises</title>
    
    <!-- Tailwind CSS (Estilos) -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Ícones Lucide -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <!-- Fonte Inter -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f3f4f6; }
        .hidden { display: none !important; }
        .required-label::after { content: '*'; color: #ef4444; margin-left: 0.25rem; }
        /* Transições suaves */
        .fade-in { animation: fadeIn 0.3s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body>

    <!-- ========================================== -->
    <!-- TELA DE LOGIN -->
    <!-- ========================================== -->
    <div id="login-screen" class="min-h-screen flex items-center justify-center bg-gray-100 p-4">
        <div class="w-full max-w-md p-8 space-y-6 bg-white rounded-xl shadow-2xl fade-in">
            <div class="text-center">
                <i data-lucide="alert-triangle" class="mx-auto w-10 h-10 text-red-600 mb-2"></i>
                <h2 class="text-3xl font-bold text-gray-900">Acesso Restrito</h2>
                <p class="mt-2 text-sm text-gray-500">Instituto Evereste - Gestão de Crises</p>
            </div>

            <div id="login-step-1" class="space-y-4">
                <div id="login-error" class="hidden text-sm text-red-600 bg-red-50 p-3 rounded-md border border-red-200"></div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700">E-mail</label>
                    <input type="email" id="email" placeholder="seu.email@evereste.org.br" class="mt-1 w-full p-3 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700">Senha</label>
                    <input type="password" id="password" placeholder="Evereste@2025" class="mt-1 w-full p-3 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500">
                </div>
                <button onclick="handleLoginStep1()" class="w-full py-3 px-4 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-md transition duration-150">
                    Entrar
                </button>
            </div>

            <div id="login-step-2" class="space-y-4 hidden">
                <div class="p-3 bg-blue-50 border border-blue-200 rounded-md">
                    <p class="text-sm text-blue-800 flex items-center">
                        <i data-lucide="check-circle" class="w-4 h-4 mr-2"></i>
                        Código enviado para seu e-mail.
                    </p>
                    <p class="text-xs text-blue-600 mt-1 ml-6">Simulação: O código é <strong>123456</strong></p>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700">Código de Verificação (2FA)</label>
                    <input type="text" id="2fa-code" placeholder="123456" maxlength="6" class="mt-1 w-full p-3 border border-gray-300 rounded-md text-center text-xl tracking-widest focus:ring-blue-500 focus:border-blue-500">
                </div>
                <div id="2fa-error" class="hidden text-sm text-red-600">Código inválido.</div>
                
                <button onclick="handleLoginStep2()" class="w-full py-3 px-4 bg-green-600 hover:bg-green-700 text-white font-bold rounded-md transition duration-150">
                    Verificar e Acessar
                </button>
            </div>
        </div>
    </div>

    <!-- ========================================== -->
    <!-- DASHBOARD PRINCIPAL (Layout) -->
    <!-- ========================================== -->
    <div id="main-app" class="hidden flex h-screen overflow-hidden bg-gray-50">
        
        <!-- Sidebar -->
        <aside class="w-64 bg-gray-900 text-white flex flex-col shadow-lg hidden md:flex">
            <div class="p-6 border-b border-gray-700">
                <h1 class="text-xl font-bold text-blue-400">EVERESTE CRISES</h1>
                <p class="text-xs text-gray-400 mt-1">Gestão de Imagem & Reputação</p>
            </div>
            <nav class="flex-grow p-4 space-y-2">
                <button onclick="switchView('dashboard')" class="nav-item w-full flex items-center p-3 rounded-lg hover:bg-gray-800 text-gray-300 hover:text-blue-400 transition-colors" id="nav-dashboard">
                    <i data-lucide="bar-chart-3" class="w-5 h-5 mr-3"></i> Dashboard
                </button>
                <button onclick="switchView('register')" class="nav-item w-full flex items-center p-3 rounded-lg hover:bg-gray-800 text-gray-300 hover:text-blue-400 transition-colors" id="nav-register">
                    <i data-lucide="plus-square" class="w-5 h-5 mr-3"></i> Registrar Ocorrência
                </button>
                <button onclick="switchView('list')" class="nav-item w-full flex items-center p-3 rounded-lg hover:bg-gray-800 text-gray-300 hover:text-blue-400 transition-colors" id="nav-list">
                    <i data-lucide="table" class="w-5 h-5 mr-3"></i> Listar Ocorrências
                </button>
                <button onclick="switchView('charts')" class="nav-item w-full flex items-center p-3 rounded-lg hover:bg-gray-800 text-gray-300 hover:text-blue-400 transition-colors" id="nav-charts">
                    <i data-lucide="line-chart" class="w-5 h-5 mr-3"></i> Gerar Gráficos
                </button>
                <button onclick="switchView('reports')" class="nav-item w-full flex items-center p-3 rounded-lg hover:bg-gray-800 text-gray-300 hover:text-blue-400 transition-colors" id="nav-reports">
                    <i data-lucide="book-open" class="w-5 h-5 mr-3"></i> Relatórios (PDF)
                </button>
                <button onclick="switchView('config')" class="nav-item w-full flex items-center p-3 rounded-lg hover:bg-gray-800 text-gray-300 hover:text-blue-400 transition-colors" id="nav-config">
                    <i data-lucide="settings" class="w-5 h-5 mr-3"></i> Configurações
                </button>
            </nav>
            <div class="p-4 border-t border-gray-700">
                <button onclick="logout()" class="w-full flex items-center p-3 rounded-lg bg-red-600 hover:bg-red-700 text-white font-bold transition-colors">
                    <i data-lucide="log-out" class="w-5 h-5 mr-3"></i> Sair
                </button>
            </div>
        </aside>

        <!-- Área de Conteúdo Principal -->
        <main class="flex-1 overflow-y-auto p-4 md:p-8 relative">
            
            <!-- Header Mobile (Apenas visual) -->
            <div class="md:hidden flex justify-between items-center mb-6 bg-white p-4 rounded-lg shadow">
                <span class="font-bold text-gray-800">EVERESTE CRISES</span>
                <button onclick="logout()" class="text-red-600"><i data-lucide="log-out"></i></button>
            </div>

            <!-- VIEW: DASHBOARD -->
            <div id="view-dashboard" class="view-section fade-in">
                <h2 class="text-3xl font-bold text-gray-800 border-b pb-2 mb-6">Dashboard Analítico</h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                    <div class="p-5 bg-white rounded-lg shadow-lg border-l-4 border-red-500">
                        <p class="text-sm font-medium text-gray-500">Crises Ativas</p>
                        <p class="mt-1 text-3xl font-extrabold text-red-700">3</p>
                    </div>
                    <div class="p-5 bg-white rounded-lg shadow-lg border-l-4 border-blue-500">
                        <p class="text-sm font-medium text-gray-500">Registros Mensais</p>
                        <p class="mt-1 text-3xl font-extrabold text-blue-700">15</p>
                    </div>
                    <div class="p-5 bg-white rounded-lg shadow-lg border-l-4 border-orange-500">
                        <p class="text-sm font-medium text-gray-500">Gravidade Média</p>
                        <p class="mt-1 text-3xl font-extrabold text-orange-700">3.8/5.0</p>
                    </div>
                </div>
                <div class="bg-white p-6 rounded-lg shadow">
                    <h3 class="text-lg font-semibold mb-4 text-gray-700">Visão Geral</h3>
                    <div class="h-64 bg-gray-100 rounded flex items-center justify-center text-gray-400 border-2 border-dashed border-gray-300">
                        [Área Reservada para Gráficos - Chart.js]
                    </div>
                </div>
            </div>

            <!-- VIEW: REGISTRAR OCORRÊNCIA (O Formulário Completo) -->
            <div id="view-register" class="view-section hidden fade-in">
                <div class="max-w-4xl mx-auto bg-white rounded-xl p-6 shadow-sm">
                    <header class="mb-8 border-b pb-4">
                        <h1 class="text-3xl font-extrabold text-blue-900 mb-2">Registro de Ocorrência</h1>
                        <p class="mt-2 text-gray-500 italic text-sm">Preencha todos os campos obrigatórios.</p>
                    </header>

                    <form id="crisis-form" onsubmit="handleFormSubmit(event)" class="space-y-8">
                        <!-- Feedback -->
                        <div id="form-feedback" class="hidden p-4 rounded-lg mb-4"></div>

                        <!-- 1. Identificação -->
                        <section class="p-6 bg-gray-50 rounded-lg border border-gray-200">
                            <h3 class="text-xl font-bold text-blue-800 mb-4">1. Identificação</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700">Data Registro</label>
                                    <input type="text" id="data-registro" class="mt-1 w-full p-3 bg-gray-200 rounded border" readonly>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 required-label">Responsável</label>
                                    <input type="text" id="responsavel" class="mt-1 w-full p-3 border rounded" required placeholder="Nome completo">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 required-label">Cargo/Setor</label>
                                    <input type="text" id="cargo" class="mt-1 w-full p-3 border rounded" required>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 required-label">Contato</label>
                                    <input type="text" id="contato" class="mt-1 w-full p-3 border rounded" required placeholder="(XX) 9XXXX-XXXX">
                                </div>
                            </div>
                        </section>

                        <!-- 2. Detalhes -->
                        <section class="p-6 bg-white rounded-lg border border-gray-200">
                            <h3 class="text-xl font-bold text-blue-800 mb-4">2. Detalhes da Crise</h3>
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 required-label">Fato Gerador</label>
                                <textarea id="fato-gerador" rows="3" class="mt-1 w-full p-3 border rounded" required></textarea>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 required-label">Data do Ocorrido</label>
                                    <input type="datetime-local" id="data-ocorrido" class="mt-1 w-full p-3 border rounded" required>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 required-label">Setor Envolvido</label>
                                    <input type="text" id="setor-envolvido" class="mt-1 w-full p-3 border rounded" required>
                                </div>
                            </div>
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 required-label">Canal de Detecção</label>
                                <div class="grid grid-cols-2 gap-2 mt-2">
                                    <label><input type="checkbox" name="canal" value="Instagram"> Instagram</label>
                                    <label><input type="checkbox" name="canal" value="LinkedIn"> LinkedIn</label>
                                    <label><input type="checkbox" name="canal" value="Imprensa"> Imprensa</label>
                                    <label><input type="checkbox" name="canal" value="Interno"> Interno</label>
                                </div>
                            </div>
                        </section>

                        <!-- 3. Classificação -->
                        <section class="p-6 bg-gray-50 rounded-lg border border-gray-200">
                            <h3 class="text-xl font-bold text-blue-800 mb-4">3. Classificação</h3>
                            <label class="block text-sm font-medium text-gray-700 required-label">Nível de Risco</label>
                            <select id="classificacao" class="mt-1 w-full p-3 border rounded" required>
                                <option value="">Selecione...</option>
                                <option value="Sem Relevância">Sem Relevância Crítica</option>
                                <option value="Potencial">Potencial</option>
                                <option value="Moderada">Moderada</option>
                                <option value="Grave">Grave</option>
                                <option value="Extrema">Extrema / Reputacional</option>
                            </select>
                        </section>

                        <button type="submit" class="w-full py-4 bg-green-600 hover:bg-green-700 text-white font-bold rounded-lg shadow-lg transform hover:scale-105 transition">
                            Salvar Ocorrência
                        </button>
                    </form>
                </div>
            </div>

            <!-- VIEW: LISTA -->
            <div id="view-list" class="view-section hidden fade-in">
                <h2 class="text-3xl font-bold text-gray-800 border-b pb-2 mb-6">Listagem de Ocorrências</h2>
                <div class="bg-white rounded-lg shadow overflow-x-auto">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-100">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Data</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Responsável</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Classificação</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Status</th>
                            </tr>
                        </thead>
                        <tbody id="tabela-corpo" class="bg-white divide-y divide-gray-200">
                            <!-- Dados simulados serão inseridos aqui via JS -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Outras views (Placeholders) -->
            <div id="view-charts" class="view-section hidden fade-in">
                <h2 class="text-3xl font-bold text-gray-800 mb-6">Gerador de Gráficos</h2>
                <p class="text-gray-500">Funcionalidade em desenvolvimento.</p>
            </div>
            <div id="view-reports" class="view-section hidden fade-in">
                <h2 class="text-3xl font-bold text-gray-800 mb-6">Exportar Relatórios</h2>
                <p class="text-gray-500">Funcionalidade em desenvolvimento.</p>
            </div>
            <div id="view-config" class="view-section hidden fade-in">
                <h2 class="text-3xl font-bold text-gray-800 mb-6">Configurações</h2>
                <p class="text-gray-500">Gerenciamento de usuários e sistema.</p>
            </div>

        </main>
    </div>

    <!-- LÓGICA JAVASCRIPT -->
    <script>
        // 1. Inicialização de Ícones
        lucide.createIcons();

        // 2. Constantes de Autenticação
        const PASSWORD_CORRECT = "Evereste@2025";
        const CODE_2FA = "123456";

        // 3. Login Logic
        function handleLoginStep1() {
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            const errorDiv = document.getElementById('login-error');

            if (password === PASSWORD_CORRECT && email.includes('@')) {
                // Sucesso no passo 1
                document.getElementById('login-step-1').classList.add('hidden');
                document.getElementById('login-step-2').classList.remove('hidden');
                errorDiv.classList.add('hidden');
            } else {
                errorDiv.textContent = "Credenciais inválidas. Verifique a senha (Evereste@2025).";
                errorDiv.classList.remove('hidden');
            }
        }

        function handleLoginStep2() {
            const code = document.getElementById('2fa-code').value;
            const errorDiv = document.getElementById('2fa-error');

            if (code === CODE_2FA) {
                // Login Completo
                document.getElementById('login-screen').classList.add('hidden');
                document.getElementById('main-app').classList.remove('hidden');
                initApp();
            } else {
                errorDiv.classList.remove('hidden');
            }
        }

        function logout() {
            location.reload(); // A forma mais simples de resetar tudo
        }

        // 4. Navegação
        function switchView(viewName) {
            // Esconde todas as views
            document.querySelectorAll('.view-section').forEach(el => el.classList.add('hidden'));
            // Remove ativo do menu
            document.querySelectorAll('.nav-item').forEach(el => {
                el.classList.remove('bg-blue-600', 'text-white');
                el.classList.add('text-gray-300');
            });

            // Mostra view selecionada
            const targetView = document.getElementById(`view-${viewName}`);
            if (targetView) targetView.classList.remove('hidden');

            // Ativa menu
            const navBtn = document.getElementById(`nav-${viewName}`);
            if (navBtn) {
                navBtn.classList.remove('text-gray-300');
                navBtn.classList.add('bg-blue-600', 'text-white');
            }
        }

        // 5. Inicialização do App
        function initApp() {
            // Define data atual no formulário
            const now = new Date().toLocaleString('pt-BR');
            document.getElementById('data-registro').value = now;
            
            // Carrega dados simulados na lista
            loadMockData();
            
            // Inicia na dashboard
            switchView('dashboard');
        }

        // 6. Formulário
        function handleFormSubmit(e) {
            e.preventDefault();
            const btn = e.target.querySelector('button[type="submit"]');
            const feedback = document.getElementById('form-feedback');
            
            // Simulação de loading
            const originalText = btn.textContent;
            btn.textContent = "Salvando...";
            btn.disabled = true;

            setTimeout(() => {
                btn.textContent = originalText;
                btn.disabled = false;
                
                // Sucesso
                feedback.className = "p-4 rounded-lg mb-4 bg-green-100 text-green-800 border border-green-200";
                feedback.textContent = "Ocorrência registrada com sucesso! ID: CRISE-" + Math.floor(Math.random() * 1000);
                feedback.classList.remove('hidden');
                
                // Limpar form
                e.target.reset();
                document.getElementById('data-registro').value = new Date().toLocaleString('pt-BR');
                
                // Atualizar lista (simulação)
                addMockRow();

            }, 1500);
        }

        // 7. Dados Simulados
        function loadMockData() {
            const tbody = document.getElementById('tabela-corpo');
            const rows = [
                { data: '20/11/2025 10:00', resp: 'Gisely Rocha', class: 'Extrema', status: 'Em Análise' },
                { data: '18/11/2025 14:30', resp: 'Vera Nascimento', class: 'Grave', status: 'Em Execução' },
            ];
            
            rows.forEach(row => insertRow(tbody, row));
        }

        function addMockRow() {
            const tbody = document.getElementById('tabela-corpo');
            const newRow = { 
                data: new Date().toLocaleString('pt-BR'), 
                resp: 'Usuário Atual', 
                class: 'Moderada', 
                status: 'Nova' 
            };
            insertRow(tbody, newRow);
        }

        function insertRow(tbody, row) {
            const tr = document.createElement('tr');
            tr.innerHTML = `
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${row.data}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${row.resp}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                    <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800">
                        ${row.class}
                    </span>
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${row.status}</td>
            `;
            tbody.prepend(tr);
        }
    </script>
</body>
</html>
